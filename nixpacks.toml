[phases.setup]
# تم إضافة pdo_mysql لتمكين الاتصال بقاعدة البيانات
nixPkgs = ['php82', 'php82Packages.composer', 'php82Extensions.pdo_mysql']

[phases.install]
cmds = [
    'composer install --no-dev --optimize-autoloader'
]

[phases.build]
cmds = [
    'php artisan config:cache',
    'php artisan route:cache',
    'php artisan view:cache',
    # تأكد من إعطاء صلاحيات للمجلدات المطلوبة
    'chmod -R 775 storage bootstrap/cache'
]

[start]
# في الإنتاج يفضل استخدام سكريبت entrypoint أو تشغيل السيرفر مباشرة عبر PHP
# إذا كنت تستخدم سكريبت railway-entrypoint.sh الذي جهزناه سابقاً:
cmd = 'sh railway-entrypoint.sh'
